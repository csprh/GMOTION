load  UKEQs2016-2018
frameName = '030A_03647_101313-vel.h5';
start = [41809 4012 1];
count = [44381-41809 4537-4012 170];


dateAll = h5read(frameName,'/Date');

theseDates = datenum(num2str(dateAll),'yyyymmdd');
days = theseDates(end)-theseDates(end-1);
interpDates = theseDates(1):days:theseDates(end);

cd = h5read(frameName,'/Cumulative_Displacement',start,count);
cdTSmooth = h5read(frameName,'/Cumulative_Displacement_TSmooth',start,count);
cdAPS = h5read(frameName,'/Cumulative_Displacement_APS',start,count);
cdFilt = h5read(frameName,'/Cumulative_Displacement_Filt',start,count);
lon1 = h5read(frameName,'/Longitude', start(1:2), count(1:2));
lat1 = h5read(frameName,'/Latitude', start(1:2), count(1:2));
cd1_100 = cd(:,:,100);
thisInd2 = isnan(cd1_100);
lon2 = lon1(~thisInd2);
lat2 = lat1(~thisInd2);


for ii = 1:size(cdTSmooth,1)
    for jj = 1:size(cdTSmooth,2)
        thisTScd = cd(ii,jj,:);
        thisTScdTSmooth = cdTSmooth(ii,jj,:);
        thisTScdAPS = cdAPS(ii,jj,:);
        thisTScdFilt = cdFilt(ii,jj,:);
        outcd(ii,jj,:) = interp1(dateAll,thisTScd, dateAllOut);
        outcdTSmooth(ii,jj,:) = interp1(dateAll,thisTScdTSmooth, dateAllOut);
        outcdAPS(ii,jj,:) = interp1(dateAll,thisTScdAPS, dateAllOut);
        outcdFilt(ii,jj,:) = interp1(dateAll,thisTScdFilt, dateAllOut);
    end
end

for ii = 1:size(outcd,3)
    this_cd = outcd(:,:,ii);
	this_cdTSmooth = outcdTSmooth(:,:,ii);
	this_cdAPS = outcdAPS(:,:,ii);
    this_cdFilt = outcdFilt(:,:,ii);
    
	thisInd = isnan(this_cdTSmooth);
    
    this_cd  = this_cd(~thisInd);
    this_cdTSmooth = this_cdTSmooth(~thisInd);
    this_cdAPS = this_cdAPS(~thisInd);
    this_cdFilt = this_cdFilt(~thisInd);
    
	cdTSmooth_1D(:,ii)= this_cdTSmooth(:);
	
end	

save stokeData_cdts2 lon2 lat2 cdTSmooth_1D cd_1D
