function out = interpRegion(frameName, cubeLenL, Latitude0S , Longitude0S)



dateAll = h5read(frameName,'/Date');
theseDates = datenum(num2str(dateAll),'yyyymmdd');
days = theseDates(end)-theseDates(end-1);
interpDates = theseDates(1):days:theseDates(end); interpDates=interpDates';

startL = [1 1]; countL = [68941 18482];

lat0 = Latitude0S-cubeLenL; lat1 = Latitude0S+cubeLenL;
lon0 = Longitude0S-cubeLenL; lon1 = Longitude0S+cubeLenL;

lonAll = h5read(frameName,'/Longitude');
latAll = h5read(frameName,'/Latitude');

ind2 = ((latAll>lat0)&(latAll<lat1)&(lonAll>lon0)&(lonAll<lon1));

clear latAll 
clear lonAll 

[a, b] = find(ind2); 
minIndLon = min(a);maxIndLon = max(a);
minIndLat = min(b);maxIndLat = max(b);

startL = [minIndLon minIndLat]; countL = [maxIndLon-minIndLon maxIndLat-minIndLat];
startLC = [startL 1]; countLC = [countL 171];
lonThis = h5read(frameName,'/Longitude', startL, countL);
latThis = h5read(frameName,'/Latitude', startL, countL);


cd = h5read(frameName,'/Cumulative_Displacement',startLC,countLC);
cdTSmooth = h5read(frameName,'/Cumulative_Displacement_TSmooth',startLC,countLC);
cdAPS = h5read(frameName,'/Cumulative_Displacement_APS',startLC,countLC);
cdFilt = h5read(frameName,'/Cumulative_Displacement_Filt',startLC,countLC);
lon1 = h5read(frameName,'/Longitude', startLC(1:2), countLC(1:2));
lat1 = h5read(frameName,'/Latitude', startLC(1:2), countLC(1:2));
cd1_100 = cd(:,:,100);
thisInd2 = isnan(cd1_100);

cd = cd(~thisInd2);
cdTSmooth = cdTSmooth(~thisInd2);
cdAPS = cdAPS(~thisInd2);
cdFilt = cdFilt(~thisInd2);
lon2 = lon1(~thisInd2);
lat2 = lat1(~thisInd2);


for ii = 1:length(cd)
    ii
    for jj = 1:size(cdTSmooth,2)
        thisTScd = cd(ii,jj,:); thisTScd = thisTScd(:);
        thisTScdTSmooth = cdTSmooth(ii,jj,:); thisTScdTSmooth = thisTScdTSmooth(:);
        thisTScdAPS = cdAPS(ii,jj,:); thisTScdAPS = thisTScdAPS(:);
        thisTScdFilt = cdFilt(ii,jj,:); thisTScdFilt = thisTScdFilt(:);
        outcd(ii,jj,:) = interp1(theseDates,thisTScd, interpDates);
        outcdTSmooth(ii,jj,:) = interp1(theseDates,thisTScdTSmooth, interpDates);
        outcdAPS(ii,jj,:) = interp1(theseDates,thisTScdAPS, interpDates);
        outcdFilt(ii,jj,:) = interp1(theseDates,thisTScdFilt, interpDates);
    end
end

for ii = 1:size(outcd,3)
    this_cd = outcd(:,:,ii);
	this_cdTSmooth = outcdTSmooth(:,:,ii);
	this_cdAPS = outcdAPS(:,:,ii);
    this_cdFilt = outcdFilt(:,:,ii);
    
	thisInd = isnan(this_cdTSmooth);
    
    this_cd  = this_cd(~thisInd);
    this_cdTSmooth = this_cdTSmooth(~thisInd);
    this_cdAPS = this_cdAPS(~thisInd);
    this_cdFilt = this_cdFilt(~thisInd);
    
    cd_1D(:,ii)= this_cd(:);
	cdTSmooth_1D(:,ii)= this_cdTSmooth(:);
	cdAPS_1D(:,ii) = this_cdAPS(:);
    cdFilt_1D(:,ii) = this_cdFilt(:);
end	

out.lon2 = lon2;
out.lat2 = lat2;
out.cd_1D = cd_1D;
out.cdTSmooth_1D =cdTSmooth_1D;
out.cdAPS_1D =cdAPS_1D;
out.cdFilt_1D =cdFilt_1D;



